<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–û—é—É–Ω—Å–∞–Ω–∞–∞ —á–∞—Ç</title>
<style>
  :root{
    /* ‚Äî –•–≠–ú–ñ–≠–≠ ‚Äî */
    --w: 540px;        /* –Ω–∏–π—Ç ”©—Ä–≥”©–Ω */
    --h: 86vh;         /* –Ω–∏–π—Ç ”©–Ω–¥”©—Ä */
    --sidebar: 240px;  /* –±–∞—Ä—É—É–Ω –º–µ–Ω—é–≥–∏–π–Ω ”©—Ä–≥”©–Ω */

    /* ‚Äî ”®–ù–ì”® ‚Äî */
    --accent:#800000;  /* —Ç–æ–ª–≥–æ–π + X + —Å—É–º */
    --send:#800000;    /* –∏–ª–≥—ç—ç—Ö —Å—É–º */
    --panel:#f6f7f9; --border:#e5e7eb; --txt:#111827; --muted
    :#6b7280;

    /* ‚Äî 4 —Ç–∞–±—ã–Ω ”©–Ω–≥”© ‚Äî */
    --tab-basic:#A3A380;   /* –≠–Ω–≥–∏–π–Ω */
    --tab-bundle:#D7CE93;  /* –ë–∞–≥—Ü */
    --tab-special:#EFEBCE; /* –¢—É—Å–≥–∞–π */
    --tab-prem:#D8A48F;    /* –ü—Ä–µ–º–∏—É–º */

    /* ‚Äî 8 “Ø–Ω–¥—Å—ç–Ω —Ç–æ–≤—á–Ω—ã –ø–∞–ª–µ—Ç—Ç ‚Äî (–∑—É—Ä–∞–≥—Ç “Ø–∑“Ø“Ø–ª—Å—ç–Ω ”©–Ω–≥”©) */
    --m1:#F1F0E2; /* –°—ç—Ç–≥—ç–ª–∏–π–Ω —Ö”©—Ç”©—á */
    --m2:#E4C7B7; /* –•”©—Ç”©–ª–±”©—Ä */
    --m3:#BBAA91; /* “Æ–π–ª—á–∏–ª–≥—ç—ç */
    --m4:#C39D88; /* –¢–µ—Å—Ç */
    --m5:#A47864; /* –°—ç—Ç–≥—ç–ª–∏–π–Ω –±–æ–ª–æ–≤—Å—Ä–æ–ª */
    --m6:#A28776; /* ”®–¥—Ä–∏–π–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª */
    --m7:#8B645A; /* –ú–∏–Ω–∏–π –±“Ø—Ä—Ç–≥—ç–ª */
    --m8:#56443F; /* –ù—É—É—Ü —Ü–æ–Ω—Ö */
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:Inter,system-ui,Segoe UI,Arial,Helvetica,sans-serif;color:var(--txt);background:#fff}

  /* ‚Äî APP (–±–∞—Ä—É—É–Ω —Ç–∞–ª–¥ –º–µ–Ω—é) ‚Äî */
  .app{
    position:fixed; right:16px; bottom:16px;
    width:var(--w); height:var(--h); max-width:96vw;
    background:#fff; border:1px solid var(--border); border-radius:14px; overflow:hidden;
    box-shadow:0 10px 28px rgba(0,0,0,.18);
    display:grid; grid-template-columns:1fr var(--sidebar); grid-template-rows:52px 1fr;
    grid-template-areas:"topbar topbar" "main sidebar"; z-index:9999;
  }
  .app.sidebar-hidden{ grid-template-columns:1fr 0; }
  .app.sidebar-hidden .sidebar{ display:none; }

  /* ‚Äî TOPBAR ‚Äî */
  .topbar{grid-area:topbar; display:flex; align-items:center; justify-content:space-between; gap:8px; padding:6px 10px; background:var(--accent); color:#fff}
  .left-actions{display:flex; align-items:center; gap:6px}
  .right-actions{display:flex; align-items:center; gap:6px}
  .ghost{border:0;background:rgba(255,255,255,.14);color:#fff;border-radius:8px; padding:8px 10px; cursor:pointer}
  .ghost:hover{background:rgba(255,255,255,.22)}
  .brand{min-width:0; font-weight:600}
  .brand .title{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

  /* ‚Äî MAIN CHAT ‚Äî */
  .main{grid-area:main; display:flex; flex-direction:column; min-width:0}
  .chat-header{height:46px; display:flex; align-items:center; justify-content:space-between; padding:0 10px; border-bottom:1px solid var(--border); background:#fff}
  .chat-body{flex:1; overflow:auto; background:var(--panel); padding:14px}
  .msg{max-width:74%; margin:8px 0; padding:10px 12px; background:#fff; border:1px solid var(--border); border-radius:12px}
  .me{margin-left:auto; background:#EFEBCE; border-color:#E3DFC8; color:#2B2B2B}
  .bot{margin-right:auto}
  .chat-input{border-top:1px solid var(--border); background:#fff; padding:8px; display:flex; gap:8px; align-items:center}
  .field{flex:1; display:flex; align-items:center; gap:8px; border:1px solid var(--border); border-radius:12px; padding:6px 8px; background:#fff}
  .field input{flex:1; border:0; outline:0; font-size:14px; padding:8px}
  .icon-btn{border:1px solid var(--border); background:#fff; border-radius:10px; padding:8px 10px; cursor:pointer}
  #sendBtn{background:var(--send); color:#fff; border:0}

  /* ‚Äî SIDEBAR (–±–∞—Ä—É—É–Ω) ‚Äî */
  .sidebar{grid-area:sidebar; min-width:var(--sidebar); max-width:var(--sidebar); border-left:1px solid var(--border); background:#fafafa; display:flex; flex-direction:column; overflow:auto}
  .user-block{padding:10px 12px; border-bottom:1px dashed var(--border); background:#fff; display:flex; align-items:center; gap:8px}
  .user-block .name{font-weight:600}
  .user-block .code{font-size:12px; color:var(--muted)}
  .menu-title{font:600 11px/1.2 Inter,system-ui; color:var(--muted); padding:10px 12px 6px}
  .menu-grid{display:grid; grid-template-columns:1fr; gap:6px; padding:0 12px 12px}
  .btn{
    display:flex; align-items:center; gap:10px; padding:10px 12px;
    border:1px solid var(--border); border-radius:12px; cursor:pointer; background:#fff;
    min-height:44px; /* —É—Ä—Ç –Ω–∞—Ä–∏–π–Ω —Ç–æ–≤—á */
  }
  .btn .t{flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color:#2B2B2B}
  .btn:hover{box-shadow:0 2px 8px rgba(0,0,0,.06)}
  /* –ø–∞–ª–µ—Ç—Ç */
  .m1{background:var(--m1)} .m2{background:var(--m2)} .m3{background:var(--m3)} .m4{background:var(--m4)}
  .m5{background:var(--m5)} .m6{background:var(--m6)} .m7{background:var(--m7)} .m8{background:var(--m8)}
  .m5 .t,.m7 .t,.m8 .t{color:#fff}

  /* ‚Äî Guide (–°—ç—Ç–≥—ç–ª–∏–π–Ω —Ö”©—Ç”©—á) ‚Äî */
  #guideSection{padding:10px 12px 12px; background:#fff; border-top:1px solid var(--border)}
  #guideTabs{display:flex; flex-direction:column; gap:6px}
  #guideTabs button{border:1px solid var(--border); border-radius:999px; padding:8px 10px; text-align:left; cursor:pointer; color:#111; background:#fff}
  #guideTabs [data-tab="standard"]{background:var(--tab-basic)}
  #guideTabs [data-tab="bundle"]  {background:var(--tab-bundle)}
  #guideTabs [data-tab="special"] {background:var(--tab-special)}
  #guideTabs [data-tab="premium"] {background:var(--tab-prem)}
  #guideTabs button.active{outline:2px solid rgba(0,0,0,.15)}
  .guide-body{display:none; margin-top:8px}
  .guide-body.active{display:block}
  .chip-row{display:grid; grid-template-columns:1fr; gap:6px}
  .chip{border:1px solid var(--border); background:#fff; border-radius:10px; padding:10px; display:flex; justify-content:space-between; align-items:center; cursor:pointer}
  .chip .meta{font-size:12px; color:#6b7280}
  .chip .star{margin-right:6px}

  /* ‚Äî Purchased ‚Äî */
  .pinned{padding:8px 12px 12px; border-top:1px solid var(--border); background:#fff}
  .pinned .item{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px; border:1px solid var(--border); border-radius:10px; margin-top:6px; background:#fff}

  /* ‚Äî BRAILLE (—Ç—É—Å–≥–∞–π ‚Üí —Ö–∞—Ä–∞–∞–Ω—ã –±—ç—Ä—Ö—à—ç—ç–ª—Ç—ç–π) ‚Äî */
  .app.braille-on, .app.braille-on .chat-body, .app.braille-on .msg{
    font-family:"Apple Braille","SimBraille","Arial Unicode MS",Arial,system-ui;
    letter-spacing:.02em;
  }

  @media (max-width:560px){
    :root{ --w:100vw; --h:100dvh; }
    .app{ left:0; right:0; top:0; bottom:0; width:100vw; height:100dvh; border-radius:0 }
  }
</style>
</head>
<body>
<div class="app" id="app">
  <!-- TOPBAR -->
  <div class="topbar">
    <div class="left-actions">
      <button class="ghost" id="hamburger" title="–ú–µ–Ω—é">‚â°</button>
      <div class="brand"><div class="title" id="topTitle">–û—é—É–Ω—Å–∞–Ω–∞–∞ —á–∞—Ç ‚Äî –ß–∞—Ç —Å–æ–Ω–≥–æ–Ω–æ —É—É</div></div>
    </div>
    <div class="right-actions">
      <button class="ghost" id="closeBtn" title="–•–∞–∞—Ö">‚úï</button>
    </div>
  </div>

  <!-- MAIN -->
  <main class="main">
    <header class="chat-header">
      <div>
        <div class="name" id="chatName">–ß–∞—Ç —Å–æ–Ω–≥–æ–Ω–æ —É—É</div>
        <div class="sub" id="chatSub" style="color:var(--muted);font-size:12px">–°–æ–Ω–≥–æ—Å–æ–Ω —á–∞—Ç–Ω—ã –Ω—ç—Ä —ç–Ω–¥ –≥–∞—Ä–Ω–∞</div>
      </div>
      <div>
        <button class="icon-btn" id="talkAI" title="–Ø—Ä–∏–ª—Ü–∞—è (AI)">–Ø—Ä–∏–ª—Ü–∞—è</button>
        <button class="icon-btn" id="talkHuman" title="–Ø—Ä–∏–ª—Ü–∞—è (–ó”©–≤–ª”©—Ö)">–Ø—Ä–∏–ª—Ü–∞—è</button>
      </div>
    </header>

    <section class="chat-body" id="chatBody">
      <div class="msg bot">–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É! –ë–∞—Ä—É—É–Ω —Ç–∞–ª—ã–Ω 8 —Ç–æ–≤—á–Ω–æ–æ—Å –Ω—ç–≥–∏–π–≥ –¥–∞—Ä–∂ —Ç—É—Ä—à–∞–∞—Ä–∞–π.</div>
    </section>

    <footer class="chat-input" id="chatForm">
      <button class="icon-btn" id="addImage" title="–ó—É—Ä–∞–≥">Ôºã</button>
      <div class="field">
        <input id="chatInput" type="text" placeholder="–≠–Ω–¥ –±–∏—á—ç—ç–¥ Enter –¥–∞—Ä–Ω–∞ —É—É‚Ä¶" />
        <button class="icon-btn" id="sendBtn" title="–ò–ª–≥—ç—ç—Ö">‚û§</button>
      </div>
    </footer>
  </main>

  <!-- SIDEBAR (–±–∞—Ä—É—É–Ω) -->
  <aside class="sidebar" id="sidebar">
    <div class="user-block">
      <div>
        <div class="name" id="userName">–ó–æ—á–∏–Ω</div>
        <div class="code">–ö–æ–¥: <span id="userCode">‚Äî</span></div>
      </div>
    </div>

    <div class="menu-title">“Æ–Ω–¥—Å—ç–Ω —Ü—ç—Å (8)</div>
    <div class="menu-grid" id="mainMenus">
      <button class="btn m1" data-main="guide"><span class="t">üß† –°—ç—Ç–≥—ç–ª–∏–π–Ω —Ö”©—Ç”©—á</span></button>
      <button class="btn m2" data-main="program"><span class="t">üìú –•”©—Ç”©–ª–±”©—Ä</span></button>
      <button class="btn m3" data-main="service"><span class="t">üõé “Æ–π–ª—á–∏–ª–≥—ç—ç</span></button>
      <button class="btn m4" data-main="test"><span class="t">‚úÖ –¢–µ—Å—Ç</span></button>
      <button class="btn m5" data-main="edu"><span class="t">üìò –°—ç—Ç–≥—ç–ª–∏–π–Ω –±–æ–ª–æ–≤—Å—Ä–æ–ª</span></button>
      <button class="btn m6" data-main="journal"><span class="t">üìù ”®–¥—Ä–∏–π–Ω —Ç—ç–º–¥—ç–≥–ª—ç–ª</span></button>
      <button class="btn m7" data-main="account"><span class="t">üë§ –ú–∏–Ω–∏–π –±“Ø—Ä—Ç–≥—ç–ª</span></button>
      <button class="btn m8" data-main="secret"><span class="t">üîí –ù—É—É—Ü —Ü–æ–Ω—Ö</span></button>
    </div>

    <!-- –°—ç—Ç–≥—ç–ª–∏–π–Ω —Ö”©—Ç”©—á -->
    <section id="guideSection" hidden>
      <div class="menu-title">üß† –°—ç—Ç–≥—ç–ª–∏–π–Ω —Ö”©—Ç”©—á</div>
      <div id="guideTabs">
        <button data-tab="standard">–≠–Ω–≥–∏–π–Ω</button>
        <button data-tab="bundle">–ë–∞–≥—Ü</button>
        <button data-tab="special">–¢—É—Å–≥–∞–π</button>
        <button data-tab="premium">‚≠ê –ü—Ä–µ–º–∏—É–º</button>
      </div>
      <div class="guide-body" data-body="standard"></div>
      <div class="guide-body" data-body="bundle"></div>
      <div class="guide-body" data-body="special"></div>
      <div class="guide-body" data-body="premium"></div>
    </section>

    <!-- –•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω -->
    <section class="pinned" id="pinnedSection" hidden>
      <div class="menu-title">üõí –•—É–¥–∞–ª–¥–∞–Ω –∞–≤—Å–∞–Ω</div>
      <div id="pinnedList"></div>
    </section>
  </aside>
</div>

<script>
(function(){
  // ===== –≠–ª–µ–º–µ–Ω—Ç“Ø“Ø–¥ =====
  const app        = document.getElementById('app');
  const sidebar    = document.getElementById('sidebar');
  const hamburger  = document.getElementById('hamburger');
  const closeBtn   = document.getElementById('closeBtn');

  const mainMenus  = document.getElementById('mainMenus');
  const guideSec   = document.getElementById('guideSection');
  const guideTabs  = document.getElementById('guideTabs');

  const chatBody   = document.getElementById('chatBody');
  const chatName   = document.getElementById('chatName');
  const chatSub    = document.getElementById('chatSub');
  const chatInput  = document.getElementById('chatInput');
  const sendBtn    = document.getElementById('sendBtn');
  const addImage   = document.getElementById('addImage');
  const topTitle   = document.getElementById('topTitle');

  const userCodeEl = document.getElementById('userCode');
  const userNameEl = document.getElementById('userName');

  const pinnedSec  = document.getElementById('pinnedSection');
  const pinnedList = document.getElementById('pinnedList');

  // ===== –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –Ω—ç—Ä/–∫–æ–¥ (demo) =====
  const savedCode = localStorage.getItem('oy_reg_code') || '‚Äî';
  const savedName = localStorage.getItem('oy_user_name') || '–ó–æ—á–∏–Ω';
  userCodeEl.textContent = savedCode;
  userNameEl.textContent = savedName;

  // ===== Demo data =====
  const DATA = {
    standard: [
      {id:'st-01', name:'–ë–∞–≥–∞ –±–∞–ª—á–∏—Ä –Ω–∞—Å (0‚Äì7)', meta:'ST-01'},
      {id:'st-02', name:'–ê–¥—Ç–∞–π –±—è—Ü—Ö–∞–Ω –Ω–∞—Å (8‚Äì12)', meta:'ST-02'},
      {id:'st-03', name:'–°—ç—Ä–≥—ç–ª—ç–Ω ”©—Å–≤”©—Ä –Ω–∞—Å (13‚Äì18)', meta:'ST-03'},
      {id:'st-04', name:'–≠—Ö–ª—ç–ª, –º”©—Ä”©”©–¥–ª–∏–π–Ω –Ω–∞—Å (19‚Äì25)', meta:'ST-04'},
      {id:'st-05', name:'–≠—Ä—Ö —á”©–ª”©”©—Ç, —ç—Ä—á —Ö“Ø—á—Ç—ç–π –Ω–∞—Å (26‚Äì40)', meta:'ST-05'},
      {id:'st-06', name:'–¢—É—Ä—à–ª–∞–≥–∞, –±“Ø—Ç—ç—ç–ª–∏–π–Ω –Ω–∞—Å (41‚Äì55)', meta:'ST-06'},
      {id:'st-07', name:'–£—Ö–∞–∞–Ω, –Ω”©–ª”©”©–ª–ª–∏–π–Ω –Ω–∞—Å (56‚Äì70)', meta:'ST-07'},
      {id:'st-08', name:'”®–≤–ª”©–∂, “Ø–ª–¥—ç—ç—Ö –Ω–∞—Å (70+)', meta:'ST-08'},
    ],
    bundle: [
      {id:'bd-01', name:'–ì—ç—Ä –±“Ø–ª', meta:'BD-01'},
      {id:'bd-02', name:'–ê–∂–∏–ª –º—ç—Ä–≥—ç–∂–∏–ª', meta:'BD-02'},
      {id:'bd-03', name:'–ê–Ω–≥–∏ —Ö–∞–º—Ç –æ–ª–æ–Ω', meta:'BD-03'},
      {id:'bd-04', name:'–°–ø–æ—Ä—Ç, —É—Ä–ª–∞–≥', meta:'BD-04'},
      {id:'bd-05', name:'–ë–∞–π–≥—É—É–ª–ª–∞–≥–∞', meta:'BD-05'},
    ],
    special: [
      {id:'sp-01', name:'–•–∞—Ä–∞–∞–Ω—ã –±—ç—Ä—Ö—à—ç—ç–ª—Ç—ç–π ‚Äî ‚††‚†ì‚†Å‚†ó‚†Å‚†Å‚†ù', meta:'SP-01', braille:true},
      {id:'sp-02', name:'–¢—É—Å–≥–∞–π —Ö—ç—Ä—ç–≥—Ü—ç—ç—Ç', meta:'SP-02'},
    ],
    premium: [
      {id:'pr-01', name:'‚≠ê –ë–∞–≥–∞ –±–∞–ª—á–∏—Ä –Ω–∞—Å (0‚Äì7)', meta:'PR-01'},
      {id:'pr-02', name:'‚≠ê –ê–¥—Ç–∞–π –±—è—Ü—Ö–∞–Ω –Ω–∞—Å (8‚Äì12)', meta:'PR-02'},
      {id:'pr-03', name:'‚≠ê –°—ç—Ä–≥—ç–ª—ç–Ω ”©—Å–≤”©—Ä –Ω–∞—Å (13‚Äì18)', meta:'PR-03'},
      {id:'pr-04', name:'‚≠ê –≠—Ö–ª—ç–ª, –º”©—Ä”©”©–¥–ª–∏–π–Ω –Ω–∞—Å (19‚Äì25)', meta:'PR-04'},
      {id:'pr-05', name:'‚≠ê –≠—Ä—Ö —á”©–ª”©”©—Ç –Ω–∞—Å (26‚Äì40)', meta:'PR-05'},
      {id:'pr-06', name:'‚≠ê –¢—É—Ä—à–ª–∞–≥–∞, –±“Ø—Ç—ç—ç–ª–∏–π–Ω –Ω–∞—Å (41‚Äì55)', meta:'PR-06'},
      {id:'pr-07', name:'‚≠ê –£—Ö–∞–∞–Ω, –Ω”©–ª”©”©–ª–ª–∏–π–Ω –Ω–∞—Å (56‚Äì70)', meta:'PR-07'},
      {id:'pr-08', name:'‚≠ê ”®–≤–ª”©–∂, “Ø–ª–¥—ç—ç—Ö –Ω–∞—Å (70+)', meta:'PR-08'},
    ],
  };

  // ===== –•”©—Ç”©—á–∏–π–Ω –∂–∞–≥—Å–∞–∞–ª—Ç —Ä—ç–Ω–¥—ç—Ä =====
  function renderBody(key){
    const body = guideSec.querySelector('.guide-body[data-body="'+key+'"]');
    if(!body) return;
    body.innerHTML = '';
    const wrap = document.createElement('div');
    wrap.className = 'chip-row';
    (DATA[key]||[]).forEach(item=>{
      const el = document.createElement('div');
      el.className = 'chip';
      el.innerHTML = '<div><div>'+item.name+'</div><div class="meta">'+(item.meta||'')+'</div></div><button class="icon-btn" title="–•–∞–¥–≥–∞–ª–∞—Ö">üìå</button>';
      el.addEventListener('click', (e)=>{ if(e.target.tagName==='BUTTON') return; openChat(item); });
      el.querySelector('button').addEventListener('click', (e)=>{ e.stopPropagation(); togglePurchase(item); });
      wrap.appendChild(el);
    });
    body.appendChild(wrap);
  }
  ['standard','bundle','special','premium'].forEach(renderBody);

  // ===== 8 “Ø–Ω–¥—Å—ç–Ω –º–µ–Ω—é =====
  mainMenus.addEventListener('click',(e)=>{
    const btn = e.target.closest('.btn'); if(!btn) return;
    const key = btn.dataset.main;

    if (key === 'guide'){
      guideSec.hidden = !guideSec.hidden;    // toggle
      if (!guideSec.hidden){
        guideTabs.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
        guideSec.querySelectorAll('.guide-body').forEach(b=>{ b.classList.remove('active'); b.style.display='none'; });
        guideSec.scrollIntoView({behavior:'smooth', block:'nearest'});
      }
      return;
    }
    guideSec.hidden = true; // –±—É—Å–∞–¥ –¥—ç—ç—Ä –¥–∞—Ä–≤–∞–ª guide —Ö–∞–∞–≥–¥–∞–Ω–∞
    openChat({id:key, name: btn.innerText.trim(), meta:'‚Äî'});
  });

  // ===== 4 —Ç–∞–± =====
  guideTabs.addEventListener('click',(e)=>{
    const t = e.target.closest('button[data-tab]'); if(!t) return;
    guideTabs.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
    t.classList.add('active');
    const key = t.dataset.tab;
    guideSec.querySelectorAll('.guide-body').forEach(b=>{
      const on = (b.dataset.body === key);
      b.classList.toggle('active', on);
      b.style.display = on ? 'block' : 'none';
    });
  });

  // ===== Chat =====
  function htmlEscape(s){return s.replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));}
  function addMsg(role, html){
    const el = document.createElement('div');
    el.className = 'msg ' + (role==='me'?'me':'bot');
    el.innerHTML = html;
    chatBody.appendChild(el);
    chatBody.scrollTop = chatBody.scrollHeight;
  }

  function openChat(item){
    app.classList.toggle('braille-on', !!item.braille);     // Braille –≥–æ—Ä–∏–º
    topTitle.textContent = '–û—é—É–Ω—Å–∞–Ω–∞–∞ —á–∞—Ç ‚Äî ' + item.name;  // –¢–æ–ª–≥–æ–π
    chatName.textContent = item.name;
    chatSub.textContent  = item.meta || '';
    chatBody.innerHTML = '';
    addMsg('bot', '–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É! <b>'+htmlEscape(item.name)+'</b> –Ω—ç—ç–≥–¥–ª—ç—ç. –Æ—É –∞—Å—É—É—Ö –≤—ç?');

    // —á–∞—Ç–ª–∞—Ö “Ø–µ–¥ –º–µ–Ω—é –∞–ª–≥–∞ –±–æ–ª–Ω–æ
    app.classList.add('sidebar-hidden');
    chatInput.focus();
  }
  window.openChat = openChat;

  function send(){
    const t = (chatInput.value||'').trim(); if(!t) return;
    addMsg('me', htmlEscape(t));
    chatInput.value='';
    setTimeout(()=> addMsg('bot','(–î–µ–º–æ) –ú–µ—Å—Å–µ–∂ —Ö“Ø–ª—ç—ç–Ω –∞–≤–ª–∞–∞.'), 260);
  }
  sendBtn.addEventListener('click', send);
  chatInput.addEventListener('keydown',(e)=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); send(); }});
  chatInput.addEventListener('focus', ()=> app.classList.add('sidebar-hidden'));

  // –∑—É—Ä–∞–≥ (demo)
  addImage.addEventListener('click', ()=>{
    addMsg('me', '–ó—É—Ä–∞–≥ –∏–ª–≥—ç—ç—Ö (–¥–µ–º–æ): <i>—Ñ–∞–π–ª —Å–æ–Ω–≥–æ–ª—Ç —ç–Ω–¥ –Ω—ç–º—ç–≥–¥—ç–Ω—ç</i>');
  });

  // ===== Purchased =====
  let purchased = JSON.parse(localStorage.getItem('oy_purchased')||'[]');
  function togglePurchase(item){
    const exists = purchased.find(x=>x.id===item.id);
    purchased = exists ? purchased.filter(x=>x.id!==item.id) : [...purchased, item];
    localStorage.setItem('oy_purchased', JSON.stringify(purchased));
    refreshPinned();
  }
  function refreshPinned(){
    pinnedList.innerHTML='';
    if(purchased.length===0){ pinnedSec.hidden=true; return; }
    pinnedSec.hidden=false;
    purchased.forEach(it=>{
      const row=document.createElement('div'); row.className='item';
      row.innerHTML=`<span>${it.name}</span><div><button class="icon-btn" title="–ù—ç—ç—Ö">‚ñ∂</button> <button class="icon-btn" title="–£—Å—Ç–≥–∞—Ö">‚úï</button></div>`;
      row.querySelectorAll('button')[0].onclick=()=>openChat(it);
      row.querySelectorAll('button')[1].onclick=()=>{
        purchased=purchased.filter(x=>x.id!==it.id);
        localStorage.setItem('oy_purchased', JSON.stringify(purchased));
        refreshPinned();
      };
      pinnedList.appendChild(row);
    });
  }
  refreshPinned();

  // ===== Topbar actions =====
  hamburger.addEventListener('click', ()=> app.classList.toggle('sidebar-hidden'));
  closeBtn.addEventListener('click', ()=>{
    app.style.display='none'; // demo —Ö–∞–∞–ª—Ç
    alert('–¶–æ–Ω—Ö —Ö–∞–∞–≥–¥–ª–∞–∞ (–¥–µ–º–æ).');
  });

  // ===== –Ø—Ä–∏–ª—Ü–∞—è 2 —Ç–æ–≤—á (demo) =====
  document.getElementById('talkAI').addEventListener('click', ()=> addMsg('bot','(AI) –°–∞–π–Ω –±–∞–π–Ω–∞ —É—É, –±–∏ —Ç—É—Å–ª–∞—Ö –±–∞–π–Ω–∞.'));
  document.getElementById('talkHuman').addEventListener('click', ()=> addMsg('bot','(–ó”©–≤–ª”©—Ö) –¢–∞–Ω–¥ —Ö—ç—Ä—Ö—ç–Ω —Ç—É—Å–ª–∞—Ö –≤—ç?'));
})();
</script>
</body>
</html>
