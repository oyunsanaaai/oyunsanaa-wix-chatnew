<style>
  :root{
    --oy-premium:#7F4D30; /* –±–∞—Ç–∞–ª—Å–∞–Ω –ø—Ä–µ–º–∏—É–º ”©–Ω–≥”© */
    --oy-bg:#fff; --oy-text:#111; --oy-muted:#757575;
  }
  #oy-fab{position:fixed;right:20px;bottom:20px;z-index:999999;
    background:var(--oy-premium);color:#fff;border:0;border-radius:999px;
    padding:12px 16px;font:600 15px/1 system-ui,-apple-system,Segoe UI,Roboto,Arial;
    box-shadow:0 8px 22px rgba(0,0,0,.22);cursor:pointer}
  #oy-chat{position:fixed;right:20px;bottom:80px;z-index:999998;
    width:380px;max-width:92vw;height:70vh;background:#fff;border-radius:14px;
    box-shadow:0 14px 34px rgba(0,0,0,.28);display:none;overflow:hidden}
  #oy-chat.oy-open{display:block}
  #oy-head{background:var(--oy-premium);color:#fff;display:flex;align-items:center;justify-content:space-between;
    padding:10px 12px;font:700 14px/1 system-ui,-apple-system,Segoe UI}
  #oy-close{background:transparent;border:0;color:#fff;font-size:18px;cursor:pointer}
  #oy-body{display:flex;flex-direction:column;height:calc(70vh - 44px);background:var(--oy-bg)}
  #oy-log{flex:1;overflow:auto;padding:12px;background:#faf9f7}
  .oy-msg{max-width:85%;margin:8px 0;padding:10px 12px;border-radius:12px;font:500 14px/1.35 system-ui,-apple-system}
  .oy-user{margin-left:auto;background:#e9e4df;color:#222}
  .oy-bot{margin-right:auto;background:#173125;color:#fff} /* bot bubble (Forest) */
  #oy-form{display:flex;gap:8px;padding:10px;border-top:1px solid #eee;background:#fff}
  #oy-input{flex:1;border:1px solid #ddd;border-radius:10px;padding:10px 12px;font:500 14px system-ui}
  #oy-send{background:var(--oy-premium);color:#fff;border:0;border-radius:10px;padding:10px 14px;font:700 14px;cursor:pointer}
  #oy-note{padding:8px 12px;color:var(--oy-muted);font:500 12px/1.3 system-ui}
  @media (max-width:420px){ #oy-chat{height:78vh} }
</style>

<button id="oy-fab" type="button">–Ø—Ä–∏–ª—Ü—ä—è
</button>

<div id="oy-chat" role="dialog" aria-label="Oyunsanaa Chat">
  <div id="oy-head">
    <span>Oyunsanaa ‚Äî –ß–∞—Ç</span>
    <button id="oy-close" aria-label="Close">‚úï</button>
  </div>
  <div id="oy-body">
    <div id="oy-log" aria-live="polite"></div>
    <div id="oy-note">–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É! –ê—Å—É—É–ª—Ç–∞–∞ –±–∏—á—ç—ç—Ä—ç–π. üòä</div>
    <form id="oy-form">
      <input id="oy-input" type="text" placeholder="–≠–Ω–¥ –±–∏—á..." autocomplete="off" />
      <button id="oy-send">–ò–ª–≥—ç—ç—Ö</button>
    </form>
  </div>
</div>

<script>
(() => {
  // -------- CONFIG (—Ç–∞ —ç–Ω–¥ API-–≥–∞–∞ —Ç–æ—Ö–∏—Ä—É—É–ª–Ω–∞) --------
  const API_URL = "YOUR_API_URL";      // –∂: https://api.yourdomain.com/chat
  const API_KEY = "YOUR_API_KEY";      // —ç—Å–≤—ç–ª —Ö–æ–æ—Å–æ–Ω –æ—Ä—Ö–∏–∂ –±–æ–ª–Ω–æ
  const HEADERS = () => ({
    "Content-Type":"application/json",
    ...(API_KEY ? { "Authorization":"Bearer "+API_KEY } : {})
  });
  // -----------------------------------------------------

  const $ = s => document.querySelector(s);
  const fab = $("#oy-fab"), panel = $("#oy-chat"), closeBtn = $("#oy-close");
  const log = $("#oy-log"), form = $("#oy-form"), input = $("#oy-input"), note = $("#oy-note");

  fab.addEventListener("click", () => panel.classList.toggle("oy-open"));
  closeBtn.addEventListener("click", () => panel.classList.remove("oy-open"));

  function addMsg(text, who="bot"){
    const div = document.createElement("div");
    div.className = "oy-msg " + (who === "user" ? "oy-user" : "oy-bot");
    div.textContent = text;
    log.appendChild(div);
    log.scrollTop = log.scrollHeight;
  }

  async function sendToAI(message){
    // –¢–∞ –±—ç–∫—ç–Ω–¥—ç—ç –¥–∞—Ä–∞–∞—Ö —Ñ–æ—Ä–º–∞—Ç–∞–∞—Ä —Ö“Ø–ª—ç—ç–∂ –∞–≤–∞—Ö–∞–¥ –∞–º–∞—Ä—Ö–∞–Ω:
    // POST API_URL { message, session_id } -> { reply }
    const payload = {
      message,
      session_id: getSession(),
    };
    const res = await fetch(API_URL, {
      method:"POST",
      headers: HEADERS(),
      body: JSON.stringify(payload)
    });
    if(!res.ok){
      const t = await res.text();
      throw new Error("API –∞–ª–¥–∞–∞: " + res.status + " " + t);
    }
    const data = await res.json();
    return data.reply || "";
  }

  function getSession(){
    // –≠–Ω–≥–∏–π–Ω session id (localStorage)
    const k="oy_session_id";
    let id = localStorage.getItem(k);
    if(!id){
      id = "oy-"+Math.random().toString(36).slice(2);
      localStorage.setItem(k,id);
    }
    return id;
  }

  // –≠—Ö–Ω–∏–π –º—ç–Ω–¥—á–∏–ª–≥—ç—ç (optional)
  if(!sessionStorage.getItem("oy_greeted")){
    addMsg("–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É! –ë–∏ —Ç–∞–Ω–¥ —Ç—É—Å–∞–ª—ä—è.");
    sessionStorage.setItem("oy_greeted","1");
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const msg = (input.value || "").trim();
    if(!msg) return;
    addMsg(msg, "user");
    input.value = "";
    note.textContent = "–ë–æ–¥–æ–∂ –±–∞–π–Ω–∞‚Ä¶";

    try{
      const reply = await sendToAI(msg);
      addMsg(reply || "–û–¥–æ–æ—Ö–æ–Ω–¥–æ–æ —Ö–∞—Ä–∏—É –∞–ª–≥–∞. –î–∞—Ö–∏–Ω –æ—Ä–æ–ª–¥–æ–Ω–æ —É—É.", "bot");
    }catch(err){
      console.error(err);
      addMsg("–£—É—á–ª–∞–∞—Ä–∞–π, —Å–µ—Ä–≤–µ—Ä—Ç—ç–π —Ö–æ–ª–±–æ–≥–¥–æ–∂ —á–∞–¥—Å–∞–Ω–≥“Ø–π. –î–∞—Ä–∞–∞ –¥–∞—Ö–∏–Ω –æ—Ä–æ–ª–¥–æ–Ω–æ —É—É.", "bot");
    }finally{
      note.textContent = "";
    }
  });
})();
</script>
